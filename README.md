# comp-int
University Project for computational intelligence

1
ΠΟΛΥΤΕΧΝΙΚΗ ΣΧΟΛΗ
ΤΜΗΜΑ ΜΗΧΑΝΙΚΩΝ Η/Υ ΚΑΙ
ΠΛΗΡΟΦΟΡΙΚΗΣ
ΥΠΟΛΟΓΙΣΤΙΚΗ ΝΟΗΜΟΣΥΝΗ
Διδάσκοντες: Σ. Λυκοθανάσης, Δ. Κουτσομητρόπουλος
Ακαδημαϊκό Έτος 2022-2023
Εργαστηριακή Άσκηση
Μέρος Α ́
A. Αναγνώριση ανθρώπινης δραστηριότητας με Χρήση Νευρωνικών Δικτύων
Η αναγνώριση ανθρώπινης δραστηριότητας (Human Activity Recognition) αποτελεί μια
διεργασία ερμηνείας της ανθρώπινης κίνησης από τα υπολογιστικά συστήματα. Οι
δραστηριότητες καταγράφονται με τη βοήθεια αισθητήρων, ενώ τα δεδομένα που προκύπτουν
αναλύονται-αξιοποιούνται από διάφορους τομείς όπως υγεία, αθλητισμός, ψυχαγωγία, κ.α.
Μια χαρακτηριστική περίπτωση αποτελεί και η προσπάθεια ταξινόμησης στάσεων-κινήσεων
του σώματος σε ένα προκαθορισμένο πλήθος κλάσεων. Συγκεκριμένα, στην παρούσα εργασία
σας δίνονται δεδομένα από τέσσερις αισθητήρες που τοποθετήθηκαν σε τέσσερις χρήστες για
συνολικά 8 ώρες, και σας ζητείται υλοποίηση που να ταξινομεί τα δεδομένα αυτά σε ακριβώς
μια από τις πέντε διαθέσιμες κλάσεις. Στην ακόλουθη εικόνα εμφανίζονται οι θέσεις των
τεσσάρων αισθητήρων (φορητά επιταχυνσιόμετρα) πάνω στο ανθρώπινο σώμα.
Ειδικότερα, πρέπει να εξετάσετε τη χρήση ενός πολυεπίπεδου ΤΝΔ για την πρόβλεψη των
5 κλάσεων (sitting-down, standing-up, standing, walking, και sitting) που αντιστοιχούν σε κάθε
δείγμα. Για τον σκοπό αυτό θα αξιοποιηθεί το σύνολο δεδομένων PUC-Rio1 που συγκεντρώνει
165.633 δείγματα για εκπαίδευση και έλεγχο. Οι ακέραιες τιμές από τους αισθητήρες μαζί με
τα βασικά στοιχεία των χρηστών, από τους οποίους έγινε η λήψη, αλλά και το είδος της
δραστηριότητας (κλάση) περιέχονται στο αρχείο dataset-HAR-PUC-Rio.csv.
Αναλυτικά, κάθε εγγραφή-γραμμή περιλαμβάνει τα εξής στοιχεία: χρήστης, φύλο, ηλικία,
ύψος, βάρος, δείκτης μάζας σώματος, (x,y,z) από αισθητήρα μέσης, (x,y,z) από αισθητήρα
αριστερού μηρού, (x,y,z) από αισθητήρα δεξιού αστράγαλου, (x,y,z) από αισθητήρα πάνω
μέρους χεριού και κλάση. Οπότε π.χ. ένα δείγμα έχει ως εξής :
wallace;Man;31;1,71;83;28,4;-24;92;-118;1;92;-128;-12;166;-87;-212;-74;-173;walking
Για την υλοποίηση των αλγορίθμων μπορείτε να χρησιμοποιήσετε οποιοδήποτε
περιβάλλον, βιβλιοθήκη ή γλώσσα προγραμματισμού κρίνετε σκόπιμο. Ενδεικτικά
αναφέρονται: MatLab, WEKA, Azure ML Studio, Google Colaboratory, TensorFlow, Keras,
SciKit-Learn.
1 https://eclass.upatras.gr/modules/document/file.php/CEID1060/dataset-HAR-PUC-Rio.csv
UCI Machine Learning Repository: Wearable Computing: Classification of Body Postures and
Movements (PUC-Rio) Data Set
2
Το ζητούμενο στην εργασία αυτή είναι να κατασκευαστεί και να εκπαιδευτεί ένα ΤΝΔ που
να ταξινομεί εισόδους (δραστηριότητες) σε 5 διαφορετικές κλάσεις.
Α1. Προεπεξεργασία και Προετοιμασία δεδομένων [20 μονάδες]
Προσοχή: Ό,τι μετασχηματισμοί εφαρμοστούν στα δεδομένα του συνόλου εκπαίδευσης, οι ίδιοι
θα πρέπει να εφαρμοστούν και στα δεδομένα του συνόλου ελέγχου ή εναλλακτικά να
αντιστραφούν πρώτου μετρηθούν οι μετρικές αξιολόγησης παρακάτω.
α) Κωδικοποίηση και προεπεξεργασία δεδομένων: Στο σύνολο δεδομένων υπάρχουν κυρίως
αριθμητικές, αλλά και κατηγορικές τιμές (φύλο, στάση σώματος). Οι κατηγορικές τιμές,
προκειμένου να μπορέσουν να χρησιμοποιηθούν στην εκπαίδευση ενός ΤΝΔ θα πρέπει να
αντιστοιχηθούν σε αριθμητικές. Για παράδειγμα, οι 5 κλάσεις (sitting-down, standing-up,
standing, walking, sitting) μπορούν να αντικατασταθούν με τις τιμές (1, 2, 3, 4, 5) σε όλο το
σύνολο δεδομένων. Οι τιμές από τους αισθητήρες, όπως αναφέρθηκε, είναι ακέραιες και
κινούνται στο διάστημα [-617,533]. Το εύρος τιμών των δεδομένων μπορεί να διαφέρει
σημαντικά ανά χαρακτηριστικό. Για αυτό τον λόγο, υπάρχει κίνδυνος να υπερεκτιμηθεί η
συνεισφορά κάποιου χαρακτηριστικού έναντι άλλων ή να υπάρξει πόλωση στις τιμές κάποιων
χαρακτηριστικών ή στις τιμές των βαρών που θα προκύψουν. Με δεδομένη την συγκεκριμένη
αποτύπωση και την πιθανή ανάγκη προσαρμογής των τιμών αυτών σε διαφορετική κλίμακα
(εξάλειψη ενδεχόμενης πόλωσης), παρουσιάζονται οι εξής τρείς μέθοδοι:
• Κεντράρισμα (Centering): Με την μέθοδο αυτή αφαιρούμε τον μέσο όρο των τιμών για
κάθε χαρακτηριστικό από όλες τις τιμές που έχουν αποδοθεί.
• Κανονικοποίηση (Normalization ή min-max scaling): Με την μέθοδο αυτή
μεταφέρουμε το εύρος τιμών ενός χαρακτηριστικού σε νέα κλίμακα πχ [0,1].
• Τυποποίηση (Standardization ή z-score): Με την μέθοδο αυτή παρέχουμε στο δείγμα
ιδιότητες όπως μηδενική μέση τιμή και μοναδιαία διακύμανση (Gaussian).
Εξετάστε τη χρησιμότητα των ανωτέρω μεθόδων για το συγκεκριμένο πρόβλημα και
εφαρμόστε τη/τις στα δεδομένα εκπαίδευσης, αν κρίνετε σκόπιμο. [15]
β) Διασταυρούμενη Επικύρωση (cross-validation): Βεβαιωθείτε ότι έχετε διαχωρίσει τα
δεδομένα σας σε σύνολα εκπαίδευσης και ελέγχου, ώστε να χρησιμοποιήσετε 5-fold CV για
όλα τα πειράματα. Προσέξτε το κάθε fold να είναι ισορροπημένο (balanced) ως προς τον αριθμό
των δειγμάτων κάθε κλάσης. [5]
Α2. Επιλογή αρχιτεκτονικής [50 μονάδες]
Όσον αφορά την τοπολογία των ΤΝΔ για την εκπαίδευση τους με τον Αλγόριθμο
Οπισθοδιάδοσης του Σφάλματος (back-propagation), θα χρησιμοποιήσετε ΤΝΔ με ένα κρυφό
επίπεδο και θα πειραματιστείτε με τον αριθμό των κρυφών κόμβων. Για την εκπαίδευση του
δικτύου χρησιμοποιήστε αρχικά ρυθμό μάθησης η = 0.001.
α) Η εκπαίδευση και αξιολόγηση των μοντέλων σας μπορεί να γίνει με χρήση Cross-Entropy
(CE), Μέσου Τετραγωνικό Σφάλματος (MSE), καθώς και ακρίβεια ταξινόμησης (Accuracy)2.
Να εξηγήσετε με απλά λόγια ποια είναι η σημασία των παραπάνω μετρικών για το
συγκεκριμένο πρόβλημα. Ποια είναι προτιμότερη για εκπαίδευση (loss); [5]
β) Πόσους νευρώνες θα χρειαστείτε στο επίπεδο εξόδου, δεδομένου του ζητούμενου της
ταξινόμησης σε πολλαπλές κλάσεις (multiclass classification); [5]
2 Πρόκειται για το ποσοστό των ορθών προβλέψεων από το δίκτυο. Αν 𝑦
^
𝑖 είναι η επιθυμητή κλάση για το δείγμα i και 𝑦𝑖 η
κλάση που προβλέπει το δίκτυο, τότε accuracy(𝑦, 𝑦
^
) = 1
𝑛samples
∑ 1(𝑦
^
𝑖 = 𝑦𝑖)
𝑛samples−1
𝑖=0
3
γ) Να επιλέξετε κατάλληλη συνάρτηση ενεργοποίησης για τους κρυφούς κόμβους και να
τεκμηριώσετε την επιλογή σας. [5]
δ) Ποια συνάρτηση ενεργοποίησης θα χρησιμοποιήσετε για το επίπεδο εξόδου; Σιγμοειδή,
γραμμική, Softmax ή κάποια άλλη; [5]
ε) Πειραματιστείτε με 3 διαφορετικές τιμές για τον αριθμό των νευρώνων του κρυφού επιπέδου
και συμπληρώστε τον παρακάτω πίνακα. Εμπειρικά ενδεδειγμένες τιμές για τον αριθμό των
κρυφών κόμβων βρίσκονται στο διάστημα [Ο, Ι+Ο] (Ι αριθμός εισόδων, Ο αριθμός εξόδων, Η
αριθμός κόμβων στο κρυφό επίπεδο). Να συμπεριλάβετε και τις γραφικές παραστάσεις
σύγκλισης (Μ.Ο.) ανά κύκλο εκπαίδευσης. Διατυπώστε τα συμπεράσματά σας σχετικά με (i)
τον αριθμό των κρυφών κόμβων, (ii) την επιλογή της συνάρτησης κόστους και (iii) την
ταχύτητα σύγκλισης ως προς τις εποχές εκπαίδευσης. [15]
Αριθμός νευρώνων
στο κρυφό επίπεδο
CE loss ΜSE Acc
Η1 = Ο
Η1 = (Ι+Ο)/2
Η1 = Ι+Ο
στ) Κριτήριο τερματισμού. Επιλέξτε και τεκμηριώστε κατάλληλο κριτήριο τερματισμού της
εκπαίδευσης κάθε φορά (για κάθε fold). Μπορεί να χρησιμοποιηθεί η τεχνική του πρόωρου
σταματήματος (early stopping); [5]
Προσοχή: σε όλα τα πειράματα θα χρησιμοποιήσετε 5-fold cross validation (5-fold CV).
Α3. Μεταβολές στον ρυθμό εκπαίδευσης και σταθεράς ορμής [15 μονάδες]
Επιλέγοντας την τοπολογία που δίνει το καλύτερο αποτέλεσμα βάσει του προηγούμενου
ερωτήματος, να πραγματοποιήσετε βελτιστοποίηση των υπερπαραμέτρων ρυθμού
εκπαίδευσης η και σταθεράς ορμής m με χρήση CV και να συμπληρώστε τον παρακάτω πίνακα.
Να συμπεριλάβετε και τις γραφικές παραστάσεις σύγκλισης (Μ.Ο.) ως προς τους κύκλους
εκπαίδευσης που θα χρειαστούν. Να τεκμηριώσετε θεωρητικά γιατί m < 1.
η m CE loss ΜSE Acc
0.001 0.2
0.001 0.6
0.05 0.6
0.1 0.6
Να διατυπώσετε σύντομα τα συμπεράσματα που προκύπτουν από τα 4 πειράματα.
Α4. Ομαλοποίηση [15 μονάδες]
Μια μέθοδος για την αποφυγή υπερπροσαρμογής του δικτύου και βελτίωση της γενικευτικής
του ικανότητας είναι η ομαλοποίηση του διανύσματος των βαρών (regularization). Να
εξηγήσετε ποια μέθοδο ομαλοποίησης (L1 ή L2) είναι προτιμότερη για το συγκεκριμένο
πρόβλημα. Στη συνέχεια να την εφαρμόσετε και να επανεκπαιδεύσετε το δίκτυό σας, όπως
προέκυψε από το Α3, αξιολογώντας διάφορες τιμές για τον συντελεστή r.
i) r = 0.1 ii) r = 0.5 iii) r = 0.9
Συμπληρώστε τον παρακάτω πίνακα για κάθε μία από τις παραπάνω περιπτώσεις με χρήση 5-
fold CV. Να συμπεριλάβετε και τις γραφικές παραστάσεις σύγκλισης (Μ.Ο.) ανά κύκλο
εκπαίδευσης.
